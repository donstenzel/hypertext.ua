# Experimental!
~ "generator" ~ Generate MakeSkel

GetExt â† âœâ‡Œ(â–½Â¬\â†¥âŠ¸âŒ•@.)

SpecialMimes â† Â°âŠŸâ‰[
  {"js" "text/javascript"}
  {"wasm" "application/wasm"}
]

ExtMime â† (
  â–¡GetExt
  SpecialMimes
  ğ„ˆâ–½âŠ™âŠ¸ğ„ˆâŒ•:
  â£(âŠ“(Â°â–¡âŠ¢|â—Œ)|â—‡âŠ‚"text/"â—Œ)
)

Response â† (
  âŠ™âŠ™âŠ¸â§»
  $$ HTTP/1.1 _
  $$ Content-Type: _
  $$ Content-Length: _
  $$ 
  $$ 
  âŠ‚ utfâ‚ˆ
)

HandleRequest â† â£(
  Response "200 OK" "text/html" &frab "root/index.html" Â°"root/"
| Response "200 OK" "text/plain" utfâ‚ˆ"Server is stopping." Â°"root/stop"
| Response "200 OK" âŠƒExtMime &frab
| Response "404 Not Found" "text/plain" utfâ‚ˆ"Not Found!" â—Œ
) âŠ‚"root"

Respond â† recv pool(
  &p$"Request by _" âŠ¸&tcpaddr
  Â°â–¡âŠ¡â‚ âŠœâ–¡âŠ¸â‰ @\s âŠ¸&ru "\r\n\r\n"
  &pâŠ¸$"Path is root_"
  HandleRequest
  send0âŠ¸(Â¬/â†¥âŒ•"Server is stopping."Â°utfâ‚ˆ)
  &p$"Response is _ bytes."âŠ¸â§»
  âŠƒâ‹…&cl&w
)

Server â† &tcpl "0.0.0.0:8000"

# print error and continue
# 1 ? error
E â† 1 &p$$ Failed to respond!
        $$ _

Run â† â¢(|â£Respondâ‹…E &tcpa Server) Generate MakeSkel
Run
